!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@tanstack/query-core"),require("jotai/vanilla"),require("jotai/vanilla/utils")):"function"==typeof define&&define.amd?define(["exports","@tanstack/query-core","jotai/vanilla","jotai/vanilla/utils"],r):r((e||self).jotaiTanstackQuery={},e.queryCore,e.vanilla,e.utils)}(this,function(e,r,t,n){var o=t.atom(new r.QueryClient);"production"!==process.env.NODE_ENV&&(o.debugPrivate=!0);var u=function(e,o,u,i){var c=t.atom(function(){return new WeakMap});"production"!==process.env.NODE_ENV&&(c.debugPrivate=!0);var a=t.atom(0);"production"!==process.env.NODE_ENV&&(a.debugPrivate=!0);var s=Symbol(),v=t.atom(function(r){r(a);var t=o(r),n=e(r),i=r(c),v=i.get(t);return v?(v[s]=!0,v.setOptions(n),delete v[s]):(v=u(t,n),i.set(t,v)),v});"production"!==process.env.NODE_ENV&&(v.debugPrivate=!0);var f=t.atom(function(r){var t=e(r),o=r(v),u={subscribe:function(e){var r=function(r){var t=function(){return e.next(r)};o[s]?Promise.resolve().then(t):t()},n=o.subscribe(r),u=o.getCurrentResult(),i=null==o.getOptimisticResult?void 0:o.getOptimisticResult(t);return r(null==u||!u.dataUpdatedAt||null==i||!i.dataUpdatedAt||(null==u?void 0:u.dataUpdatedAt)>=(null==i?void 0:i.dataUpdatedAt)?u:i),{unsubscribe:n}}},i=n.atomWithObservable(function(){return u},{initialValue:o.getCurrentResult()});return"production"!==process.env.NODE_ENV&&(i.debugPrivate=!0),i});"production"!==process.env.NODE_ENV&&(f.debugPrivate=!0);var d=t.atom(function(e){var r=e(f);return e(r)},function(e,r,t){var n=e(v);return i(t,n,function(){var t=o(e);e(c).delete(t),r(a,function(e){return e+1})})}),l=t.atom(function(t){var o=e(t),u=t(v),i={subscribe:function(e){var t=function(t){if(t.isSuccess&&void 0!==t.data||t.isError&&!r.isCancelledError(t.error)){var n=function(){return e.next(t)};u[s]?Promise.resolve().then(n):n()}},n=u.subscribe(t),i=u.getCurrentResult(),c=null==u.getOptimisticResult?void 0:u.getOptimisticResult(o);return t(null==i||!i.dataUpdatedAt||null==c||!c.dataUpdatedAt||(null==i?void 0:i.dataUpdatedAt)>=(null==c?void 0:c.dataUpdatedAt)?i:c),{unsubscribe:n}}},c=n.atomWithObservable(function(){return i});return"production"!==process.env.NODE_ENV&&(c.debugPrivate=!0),c});"production"!==process.env.NODE_ENV&&(l.debugPrivate=!0);var p=function(e){if(e.error)throw e.error;return e.data};return[t.atom(function(e){var r=e(l),t=e(r);return t instanceof Promise?t.then(p):p(t)},function(e,r,t){return r(d,t)}),d]};e.atomsWithInfiniteQuery=function(e,t){return void 0===t&&(t=function(e){return e(o)}),u(e,t,function(e,t){return new r.InfiniteQueryObserver(e,t)},function(e,r,t){return"refetch"===e.type?e.force?(r.remove(),void t()):r.refetch(e.options):"fetchNextPage"===e.type?r.fetchNextPage():"fetchPreviousPage"===e.type?r.fetchPreviousPage():void 0})},e.atomsWithMutation=function(e,t){return void 0===t&&(t=function(e){return e(o)}),u(e,t,function(e,t){return new r.MutationObserver(e,t)},function(e,r){return r.mutate.apply(r,e)})},e.atomsWithQuery=function(e,t){return void 0===t&&(t=function(e){return e(o)}),u(e,t,function(e,t){return new r.QueryObserver(e,t)},function(e,r,t){if("refetch"===e.type)return e.force?(r.remove(),void t()):r.refetch(e.options)})},e.atomsWithQueryAsync=function(e,u){return void 0===u&&(u=function(e){return e(o)}),function(e,o,u,i){var c=t.atom(function(){return new WeakMap});"production"!==process.env.NODE_ENV&&(c.debugPrivate=!0);var a=t.atom(0);"production"!==process.env.NODE_ENV&&(a.debugPrivate=!0);var s=Symbol(),v=t.atom(function(t){try{return t(a),Promise.resolve(e(t)).then(function(e){var n=o(t),u=t(c),i=u.get(n);return i?(i[s]=!0,i.setOptions(e),delete i[s]):(i=function(e,t){return new r.QueryObserver(e,t)}(n,e),u.set(n,i)),i})}catch(e){return Promise.reject(e)}});"production"!==process.env.NODE_ENV&&(v.debugPrivate=!0);var f=t.atom(function(e){try{return Promise.resolve(e(v)).then(function(e){var r={subscribe:function(r){var t=function(t){var n=function(){return r.next(t)};e[s]?Promise.resolve().then(n):n()},n=e.subscribe(t);return t(e.getCurrentResult()),{unsubscribe:n}}},t=n.atomWithObservable(function(){return r},{initialValue:e.getCurrentResult()});return"production"!==process.env.NODE_ENV&&(t.debugPrivate=!0),t})}catch(e){return Promise.reject(e)}});"production"!==process.env.NODE_ENV&&(f.debugPrivate=!0);var d=t.atom(function(e){try{return Promise.resolve(e(f)).then(e)}catch(e){return Promise.reject(e)}},function(e,r,t){try{return Promise.resolve(e(v)).then(function(n){return Promise.resolve(function(t,n,u){try{return Promise.resolve(function(){if("refetch"===t.type)return t.force?(n.remove(),u=o(e),e(c).delete(u),void r(a,function(e){return e+1})):Promise.resolve(n.refetch(t.options));var u}())}catch(e){return Promise.reject(e)}}(t,n))})}catch(e){return Promise.reject(e)}}),l=t.atom(function(t){try{return e(t),Promise.resolve(t(v)).then(function(e){var t={subscribe:function(t){var n=function(n){if(n.isSuccess&&void 0!==n.data||n.isError&&!r.isCancelledError(n.error)){var o=function(){return t.next(n)};e[s]?Promise.resolve().then(o):o()}},o=e.subscribe(n);return n(e.getCurrentResult()),{unsubscribe:o}}},o=n.atomWithObservable(function(){return t});return"production"!==process.env.NODE_ENV&&(o.debugPrivate=!0),o})}catch(e){return Promise.reject(e)}});"production"!==process.env.NODE_ENV&&(l.debugPrivate=!0);var p=function(e){if(e.error)throw e.error;return e.data};return[t.atom(function(e){try{return Promise.resolve(e(l)).then(function(r){return Promise.resolve(e(r)).then(function(e){return e instanceof Promise?e.then(p):Promise.resolve(p(e))})})}catch(e){return Promise.reject(e)}},function(e,r,t){return r(d,t)}),d]}(e,u)},e.queryClientAtom=o});
//# sourceMappingURL=index.umd.js.map
